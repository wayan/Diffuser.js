<!DOCTYPE html>
<html>
<head>
<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>
<script src="Geometry.js"></script>
<script src="Drawing.js"></script>
<script src="Diffuser.js"></script>
<script src="Fn.js"></script>
<script src="FileSaver.js"></script>

<script>
jQuery(function($){
    const rawParams = Fn.hashParams(), 
        ppi = ('ppi' in rawParams? parseFloat(rawParams.ppi): 157), 
        w = new Drawing({ magnify: ppi / 2.54, }),
        shape = rawParams['shape'] || 1,
        diffuser = Diffuser(shape),
        params = diffuser.parseParams(rawParams);

    diffuser.create(params, w);

    $('#download-svg-link').click((e) => {
        const content = Fn.serializeSvg( $('svg') ),
        blob = new Blob([content], {type: "image/svg+xml;charset=utf-8"});
        saveAs(blob, "diffuser.svg");
        return false;
    });
});
</script>
</head>
<body>

<a id="download-svg-link" >Download SVG</a>

<svg width="1800" height="1000">
  Sorry, your browser does not support inline SVG.
</svg>

</body>
</html>
